To implement:

1. Can't have loops among connections, although bypass might require us to
change that.
